---
title: "Water Data Exploration"
author: "Badhia Yunes Katz"
date: "August 2025"
---


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE, 
  message = FALSE,
  echo = FALSE,
  comment = "#>", 
  fig.width=8, fig.height=5)

library(tidyverse)
library(dataRetrieval)
library(leaflet)
library(janitor)
library(dplyr)

colors_full <-  c("#9A8822", "#F5CDB4", "#F8AFA8", "#FDDDA0", "#74A089", #Royal 2
                  "#899DA4", "#C93312", "#DC863B", # royal 1 (- 3)
                  "#F1BB7B", "#FD6467", "#5B1A18", # Grand Budapest 1 (-4)
                  "#D8B70A", "#02401B", "#A2A475", # Cavalcanti 1
                  "#E6A0C4", "#C6CDF7", "#D8A499", "#7294D4", #Grand Budapest 2
                  "#9986A5", "#EAD3BF", "#AA9486", "#B6854D", "#798E87" # Isle of dogs 2 altered slightly
)
```

## Overview

This document summarizes USGS temperature and flow data from gages across the Klamath Basin. For each gage, a time series plot and a summary of the available date range have been generated to provide an easy visual reference for data availability and to highlight any gaps.

### USGS - Flow {.tabset .tabset-fade .tabset-pills}


#### Main stream Klamath 

  - 11509500 - Klamath River at Keno Or
  - 11510700 - Klamath River Below John C Boyle Powerplant
  - 11516530 - Klamath River Below Iorngate Dam 
  - 11520500 - Klamath River Nr Seiad Valley CA
  - 11523000 - Klamath River A Orleans 
  - 11530500 - Klamath River Near Klamath (Furthest Downstream)
  
```{r, include=FALSE}
kr_at_keno_or <- dataRetrieval::readNWISdv(11509500, "00060", startDate = "1950-01-01") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter 
         # order = 1,
         gage_agency = "USGS",
         gage_number = "11509500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11509500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11509500")$dec_long_va) # directly add lon

kr_blw_powerplant <- dataRetrieval::readNWISdv(11510700, "00060", startDate = "1995-01-01") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter 
         # order = 2,
         gage_agency = "USGS",
         gage_number = "11510700",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
                  latitude = dataRetrieval::readNWISsite("11510700")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11510700")$dec_long_va) 

kr_blw_iorngage <- dataRetrieval::readNWISdv(11516530, "00060", startDate = "1950-01-01") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter 
         # order = 3,
         gage_agency = "USGS",
         gage_number = "11516530",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11516530")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11516530")$dec_long_va 
         ) 
kr_nr_seiad_valley <- dataRetrieval::readNWISdv(11520500, "00060", startDate = "1950-01-01") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter 
         # order = 4,
         gage_agency = "USGS",
         gage_number = "11520500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11520500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11520500")$dec_long_va 
         ) 
kr_at_orleans <- dataRetrieval::readNWISdv(11523000, "00060", startDate = "1950-01-01") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter 
         # order = 5,
         gage_agency = "USGS",
         gage_number = "11523000",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11523000")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11523000")$dec_long_va 
         ) 
kr_nr_klamath <- dataRetrieval::readNWISdv(11530500, "00060", startDate = "1950-01-01") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter 
         # order = 6,
         gage_agency = "USGS",
         gage_number = "11530500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11530500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11530500")$dec_long_va 
         )

all_kalamth_usgs_gages <- bind_rows(kr_at_keno_or, kr_blw_powerplant, kr_blw_iorngage, kr_nr_seiad_valley, 
                                    kr_at_orleans, kr_nr_klamath) |> 
  glimpse()
```

##### Date coverage

```{r, echo=FALSE}
all_kalamth_usgs_gages |> ggplot(aes(x = date, y = value, color = as.character(gage_number))) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal() +
  labs(title = "Flow vs Date by Gage Number",
       y = "Flow")
```

##### Date range summary

```{r, echo=FALSE}
date_range_summary <- all_kalamth_usgs_gages |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()   |> 
  print()
```

#### Trinity 

Potential gages

  - 11528700 SF TRINITY R BL HYAMPOM CA - South fork
  - 11530000 TRINITY R A HOOPA CA
  - 11523200 TRINITY R AB COFFEE C NR TRINITY CENTER CA
  - 11525500 TRINITY R A LEWISTON CA
  - 11525655 TRINITY R BL LIMEKILN GULCH NR DOUGLAS CITY CA
  - 11525854 TRINITY R A DOUGLAS CITY CA
  - 11526250 TRINITY R A JUNCTION CITY CA
  - 11526400 TRINITY R AB NF TRINITY R NR HELENA CA
  - 11527000 TRINITY R NR BURNT RANCH CA
  
```{r, include=FALSE}
tr_sf <- dataRetrieval::readNWISdv(11528700, "00060") |>  # 1965/10/01 - 2024/09/03
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "trinity river - south fork", # south fork
         gage_agency = "USGS",
         gage_number = "11528700",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11528700")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11528700")$dec_long_va 
         ) 
tr_hoopa <- dataRetrieval::readNWISdv(11530000, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "trinity river",
         gage_agency = "USGS",
         gage_number = "11530000",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11530000")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11530000")$dec_long_va 
         ) 
tr_ab_coffee <- dataRetrieval::readNWISdv(11523200, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "trinity river",
         gage_agency = "USGS",
         gage_number = "11523200",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11523200")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11523200")$dec_long_va 
         ) 
tr_lewiston <- dataRetrieval::readNWISdv(11525500, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "trinity river",
         gage_agency = "USGS",
         gage_number = "11525500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11525500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11525500")$dec_long_va 
         ) 
tr_douglas <- dataRetrieval::readNWISdv(11525655, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "trinity river",
         gage_agency = "USGS",
         gage_number = "11525655",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11525655")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11525655")$dec_long_va 
         ) 
tr_dgcity <- dataRetrieval::readNWISdv(11525854, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "trinity river",
         gage_agency = "USGS",
         gage_number = "11525854",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11525854")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11525854")$dec_long_va 
         ) 
tr_city <- dataRetrieval::readNWISdv(11526250, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "trinity river",
         gage_agency = "USGS",
         gage_number = "11526250",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11526250")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11526250")$dec_long_va 
         ) 
tr_helena <- dataRetrieval::readNWISdv(11526400, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "trinity river",
         gage_agency = "USGS",
         gage_number = "11526400",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11526400")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11526400")$dec_long_va 
         ) 
tr_brun <- dataRetrieval::readNWISdv(11527000, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "trinity river",
         gage_agency = "USGS",
         gage_number = "11527000",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11527000")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11527000")$dec_long_va 
         ) 

all_trinity_usgs_gages <- bind_rows(tr_sf, tr_hoopa, tr_ab_coffee, tr_lewiston, tr_douglas, tr_dgcity, tr_city, tr_helena, tr_brun)
```
##### Date coverage per gage

```{r, echo=FALSE}
all_trinity_usgs_gages |> ggplot(aes(x = year(date), y = value, color = gage_number)) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal()
```

##### Date range summary

```{r, echo=FALSE}
date_range_summary_trinity <- all_trinity_usgs_gages |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()  |> 
  print()
```

#### Scott 

  - 11519500 SCOTT R NR FORT JONES CA
```{r, include=FALSE}
scott <- dataRetrieval::readNWISdv(11519500, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "scott river",
         gage_agency = "USGS",
         gage_number = "11519500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11519500")$dec_lat_va,
         longitude = dataRetrieval::readNWISsite("11519500")$dec_long_v) 
```

##### Date coverage

```{r echo=FALSE}
scott |> ggplot(aes(x = year(date), y = value, color = gage_number)) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal()
```

##### Date range summary

```{r, echo=FALSE}
scott |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()   |> 
  print()
```

#### Shasta 

  - Shasta R NR Montague CA - 11517000
  - Shasta R NR Yreka CA - 11517500

```{r, include=FALSE}
shasta_mont <- dataRetrieval::readNWISdv(11517000, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "shasta river",
         gage_agency = "USGS",
         gage_number = "11517000",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11517000")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11517000")$dec_long_va 
         ) 

shasta_yreka <- dataRetrieval::readNWISdv(11517500, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "shasta river",
         gage_agency = "USGS",
         gage_number = "11517500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11517500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11517500")$dec_long_va 
         ) 

all_usgs_shasta <- bind_rows(shasta_mont, shasta_yreka) |> 
  glimpse()
```

##### Date coverage plot

```{r, echo=FALSE}
all_usgs_shasta |> ggplot(aes(x = year(date), y = value, color = gage_number)) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal()
```

##### Date range summary

```{r, echo=FALSE}
date_range_summary_shasta <- all_usgs_shasta |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()  |> 
  print()
```

#### Salmon 

  - 11522500 SALMON R A SOMES BAR CA
  
```{r, include=FALSE}
salmon_usgs_gage <- dataRetrieval::readNWISdv(11522500, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "shasta river",
         gage_agency = "USGS",
         gage_number = "11522500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11522500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11522500")$dec_long_va)
```

##### Date coverage plot

```{r, echo=FALSE, message=FALSE, warning=FALSE}
salmon_usgs_gage |> ggplot(aes(x = year(date), y = value)) + 
  geom_line() +
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal()
```

##### Date range summary

```{r, echo=FALSE, warning=FALSE, message=FALSE}
date_range_summary_salmon <- salmon_usgs_gage |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()  |> 
  print()
```

#### Indian Creek 

List of USGS gages in Klamath watershed: 

  - Indian C NR Douglas City CA - 11525670
  - Indian C NR Happy Camp CA - 11521500
  
```{r, include=FALSE}
indian_usgs_doug <- dataRetrieval::readNWISdv(11525670, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "indian creek",
         gage_agency = "USGS",
         gage_number = "11525670",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11525670")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11525670")$dec_long_va # directly add lon
         )
indian_usgs_happy <- dataRetrieval::readNWISdv(11521500, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "indian creek",
         gage_agency = "USGS",
         gage_number = "11521500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11521500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11521500")$dec_long_va # directly add lon
         )

all_indian_usgs_gages <- bind_rows(indian_usgs_doug, indian_usgs_happy) |>
  glimpse()
```

##### Date coverage

```{r, echo=FALSE}
all_indian_usgs_gages |> ggplot(aes(x = date, y = value, color = gage_number)) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal()
```


#### Other streams - Oregon 

  - Klamath Straits Drain Near Worden, OR - 11509340
  - Ady Canal Above Lower Klamath Nwr, Near Worden, OR - 11509250
  - North Canal at Highway 97, Near Midland, OR - 11509105
  - Link River at Klamath Falls, OR - 11507500
  - Williamson River Blw Sprague River NR Chiloquin,or - 11502500
  - Crystal Creek Near Rocky Point, OR - 11504270 - NODATA
  - Fourmile Canal Near Klamath Agency, OR - 11504260
  - Sevenmile Cnl at Dike RD Br, NR Klamath Agency, OR - 11504290

```{r, include=FALSE}
other_usgs_or1 <- dataRetrieval::readNWISdv(11509340, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "other",
         gage_agency = "USGS",
         gage_number = "11509340",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11509340")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11509340")$dec_long_va # directly add lon
         )
other_usgs_or2 <- dataRetrieval::readNWISdv(11509250, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "other",
         gage_agency = "USGS",
         gage_number = "11509250",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11509250")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11509250")$dec_long_va # directly add lon
         )
other_usgs_or3 <- dataRetrieval::readNWISdv(11509105, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "other",
         gage_agency = "USGS",
         gage_number = "11509105",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11509105")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11509105")$dec_long_va # directly add lon
         )
other_usgs_or4 <- dataRetrieval::readNWISdv(11507500, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "other",
         gage_agency = "USGS",
         gage_number = "11507500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11507500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11507500")$dec_long_va # directly add lon
         )
other_usgs_or5 <- dataRetrieval::readNWISdv(11502500, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "other",
         gage_agency = "USGS",
         gage_number = "11502500",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11502500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11502500")$dec_long_va # directly add lon
         )

other_usgs_or6 <- dataRetrieval::readNWISdv(11504260, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "other",
         gage_agency = "USGS",
         gage_number = "11504260",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11504260")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11504260")$dec_long_va # directly add lon
         )
other_usgs_or7 <- dataRetrieval::readNWISdv(11504290, "00060") |> 
  select(date = Date, value =  X_00060_00003) |>  # rename to value
  as_tibble() |> 
  mutate(stream = "other",
         gage_agency = "USGS",
         gage_number = "11504290",
         parameter = "flow",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11504290")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11504290")$dec_long_va # directly add lon
         )

all_or_usgs_gages <- bind_rows(other_usgs_or1, other_usgs_or2, other_usgs_or3, other_usgs_or4, other_usgs_or5, other_usgs_or6, other_usgs_or7) |>
  glimpse()
```

##### Date coverage

```{r, echo=FALSE}
all_or_usgs_gages |> ggplot(aes(x = date, y = value, color = gage_number)) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

##### Date range summary

```{r, echo=FALSE}
date_range_summary_or <- all_or_usgs_gages |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()  |> 
  print()
```

### USGS - Temperature {.tabset .tabset-fade .tabset-pills}

#### Main stream Klamath 

  - LINK RIVER AT KLAMATH FALLS, OR	11507500
  - KLAMATH RIVER BLW JOHN C.BOYLE PWRPLNT, NR KENO,OR	11510700
  - KLAMATH R NR KLAMATH CA	11530500
  - KLAMATH R A ORLEANS	11523000
  - KLAMATH RIVER AT KENO, OR	11509500
  - KLAMATH RIVER ABOVE KENO DAM, AT KENO, OR	11509370
  - KLAMATH RIVER ABV KENO DAM, AT KENO - BOTTOM	420741121554001
  - KLAMATH STRAITS DRAIN NEAR HIGHWAY 97, OR	420451121510000
  - KLAMATH STRAITS DRAIN ABOVE F-FF PUMPS, WORDEN, OR	420448121503100
  - KLAMATH RIVER AT MILLER ISLAND BOAT RAMP, OR	420853121505500
  - KLAMATH RIVER AT MILLER ISLAND BOAT RAMP-BOTTOM	420853121505501
  

```{r, include=FALSE}
klamath_fl <- dataRetrieval::readNWISdv(11507500, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11507500",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11507500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11507500")$dec_long_va # directly add lon
         )
klamath_keno <- dataRetrieval::readNWISdv(11510700, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11510700",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11510700")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11510700")$dec_long_va # directly add lon
         )
klamath_kl <- dataRetrieval::readNWISdv(11530500, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11530500",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11530500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11530500")$dec_long_va # directly add lon
         )
klamath_or <- dataRetrieval::readNWISdv(11523000, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11523000",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11523000")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11523000")$dec_long_va # directly add lon
         )
klamath_keno_or <- dataRetrieval::readNWISdv(11509500, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11509500",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11509500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11509500")$dec_long_va # directly add lon
         )
klamath_ab_keno_or <- dataRetrieval::readNWISdv(11509370, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11509370",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11509370")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11509370")$dec_long_va # directly add lon
         )
klamath_ab_keno_bot <- dataRetrieval::readNWISdv(420741121554001, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", 
         gage_agency = "USGS",
         gage_number = "420741121554001",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("420741121554001")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("420741121554001")$dec_long_va 
         )
klamath_nr_97 <- dataRetrieval::readNWISdv(420451121510000, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", # TODO should we all it klamath straits drain?
         gage_agency = "USGS",
         gage_number = "420451121510000",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("420451121510000")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("420451121510000")$dec_long_va # directly add lon
         )
klamath_ab_pumps <- dataRetrieval::readNWISdv(420448121503100, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", # TODO should we all it klamath straits drain?
         gage_agency = "USGS",
         gage_number = "420448121503100",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("420448121503100")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("420448121503100")$dec_long_va 
         )
klamath_mill <- dataRetrieval::readNWISdv(420853121505500, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", 
         gage_agency = "USGS",
         gage_number = "420853121505500",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("420853121505500")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("420853121505500")$dec_long_va 
         )
klamath_mill_ramp <- dataRetrieval::readNWISdv(420853121505501, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river", 
         gage_agency = "USGS",
         gage_number = "420853121505501",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("420853121505501")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("420853121505501")$dec_long_va 
         )

mainsteam <- bind_rows(klamath_fl, klamath_keno, klamath_kl, klamath_or, klamath_keno_or, klamath_ab_keno_or, klamath_ab_keno_bot, klamath_nr_97, klamath_ab_pumps, klamath_mill, klamath_mill_ramp)
```  

##### Date coverage

```{r, echo=FALSE}
mainsteam |> ggplot(aes(x = date, y = value, color = as.character(gage_number))) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal() +
  labs(title = "Temperature vs Date by Gage Number",
       y = "Temperature")
```
  
##### Date range summary

```{r, echo=FALSE}
mainsteam |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()  |> 
  print()
```

#### Trinity

  - TRINITY R AB NF TRINITY R NR HELENA CA	11526400
  - TRINITY R A HOOPA CA	11530000

```{r, include=FALSE}
trinity_id <- dataRetrieval::readNWISdv(11526400, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "trinity river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11526400",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11526400")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11526400")$dec_long_va # directly add lon
         )
trinity_hoop <- dataRetrieval::readNWISdv(11530000, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "trinity river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11530000",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11530000")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11530000")$dec_long_va # directly add lon
         )
trinity <- bind_rows(trinity_id, trinity_hoop)
```

##### Date coverage

```{r, echo=FALSE}
trinity |> ggplot(aes(x = date, y = value, color = as.character(gage_number))) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal() +
  labs(title = "Temperature vs Date by Gage Number",
       y = "Temperature")
```

##### Date range summary

```{r, echo=FALSE}
trinity |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()  |> 
  print()
```

#### Klamath Upper Lake 

  - RATTLESNAKE POINT - RPT	422042121513100
  - UPPER KLAMATH LAKE AT HOWARD BAY, OR	421935121551200
  - MID-TRENCH - LOWER - MDTL	422305121553800
  - MID-TRENCH - UPPER - MDTU	422305121553803
  - SHOALWATER BAY - SHB	422444121580400
  - MID-NORTH - LOWER - MDNL 422622122004000
  - MID-NORTH - UPPER - MDNU	422622122004003
  - WILLIAMSON RIVER OUTLET - WMR	422719121571400
  - SEVENMILE CNL AT DIKE RD BR, NR KLAMATH AGENCY, OR	11504290
  
```{r, include=FALSE}
kl_lake  <- dataRetrieval::readNWISdv(422042121513100, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "upper klamath lake", 
         gage_agency = "USGS",
         gage_number = "422042121513100",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("422042121513100")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("422042121513100")$dec_long_va 
         )
kl_lake_bay  <- dataRetrieval::readNWISdv(421935121551200, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "upper klamath lake", 
         gage_agency = "USGS",
         gage_number = "421935121551200",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("421935121551200")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("421935121551200")$dec_long_va 
         )
kl_lake_lower_mdtl  <- dataRetrieval::readNWISdv(422305121553800, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "upper klamath lake", 
         gage_agency = "USGS",
         gage_number = "422305121553800",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("422305121553800")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("422305121553800")$dec_long_va 
         )
kl_lake_upper_mdtl  <- dataRetrieval::readNWISdv(422305121553803, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "upper klamath lake", 
         gage_agency = "USGS",
         gage_number = "422305121553803",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("422305121553803")$dec_lat_va, # this is the same location as gage above
         longitude = dataRetrieval::readNWISsite("422305121553803")$dec_long_va 
         )
sho_bay  <- dataRetrieval::readNWISdv(422444121580400, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "upper klamath lake", 
         gage_agency = "USGS",
         gage_number = "422444121580400",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("422444121580400")$dec_lat_va, # this is the same location as gage above
         longitude = dataRetrieval::readNWISsite("422444121580400")$dec_long_va 
         )
nr_low_mdnl  <- dataRetrieval::readNWISdv(422622122004000, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "upper klamath lake", 
         gage_agency = "USGS",
         gage_number = "422622122004000",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("422622122004000")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("422622122004000")$dec_long_va 
         )
nr_upper_mdnl  <- dataRetrieval::readNWISdv(422622122004003, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "upper klamath lake", 
         gage_agency = "USGS",
         gage_number = "422622122004003",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("422622122004003")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("422622122004003")$dec_long_va 
         )
will_outlet  <- dataRetrieval::readNWISdv(422719121571400, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "upper klamath lake", 
         gage_agency = "USGS",
         gage_number = "422719121571400",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("422719121571400")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("422719121571400")$dec_long_va)

kl_lake_temp_points <- bind_rows(kl_lake, kl_lake_bay, kl_lake_lower_mdtl, kl_lake_upper_mdtl, sho_bay, nr_low_mdnl, nr_upper_mdnl, will_outlet)
```

##### Date coverage

```{r, echo=FALSE}
kl_lake_temp_points |> ggplot(aes(x = date, y = value, color = as.character(gage_number))) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal() +
  labs(title = "Temperature vs Date by Gage Number",
       y = "Temperature")
```

##### Date range summary

```{r, echo=FALSE}
kl_lake_temp_points |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()  |> 
  print()
```

#### Lost River

  - LOST RVR AT ANDERSON ROSE DVRSN DAM AT MALONE, OR	420037121334100
  - LOST RVR BLW ANDERSON ROSE DVRSN DAM AT MALONE, OR	420036121333700
  - LOST RIVER AT WILSON DAM, AT HENLEY, OR	420833121402000
  - LOST R AT BR XING BLW HARPOLD DAM, NR BONANZA, OR	421010121271200
  - LOST RIVER DIVERSION CHANNEL NR KLAMATH RIVER, OR	421015121471800
  - LOST RIVER AT STATELINE ROAD, NR HATFIELD, CA	415954121312100

```{r, include=FALSE}
lost_rvr  <- dataRetrieval::readNWISdv(420037121334100, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "lost river", 
         gage_agency = "USGS",
         gage_number = "420037121334100",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("420037121334100")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("420037121334100")$dec_long_va 
         )
lost_rvr_and  <- dataRetrieval::readNWISdv(420036121333700, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "lost river", 
         gage_agency = "USGS",
         gage_number = "420036121333700",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("420036121333700")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("420036121333700")$dec_long_va 
         )
lost_rvr_wilson  <- dataRetrieval::readNWISdv(420833121402000, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "lost river diverson dam", 
         gage_agency = "USGS",
         gage_number = "420833121402000",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("420833121402000")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("420833121402000")$dec_long_va 
         )
lost_bl_dam  <- dataRetrieval::readNWISdv(421010121271200, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "lost river", 
         gage_agency = "USGS",
         gage_number = "421010121271200",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("421010121271200")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("421010121271200")$dec_long_va 
         )
lost_div_chan  <- dataRetrieval::readNWISdv(421015121471800, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "lost river", 
         gage_agency = "USGS",
         gage_number = "421015121471800",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("421015121471800")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("421015121471800")$dec_long_va 
         )
lost_hatfield  <- dataRetrieval::readNWISdv(415954121312100, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "lost river", 
         gage_agency = "USGS",
         gage_number = "415954121312100",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("415954121312100")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("415954121312100")$dec_long_va 
         )

lost_points <- bind_rows(lost_rvr, lost_rvr_and, lost_rvr_wilson, lost_bl_dam, lost_div_chan, lost_hatfield)
```

##### Date coverage

```{r, echo=FALSE}
lost_points |> ggplot(aes(x = date, y = value, color = as.character(gage_number))) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal() +
  labs(title = "Temperature vs Date by Gage Number",
       y = "Temperature")
```

##### Date range summary

```{r, echo=FALSE}
lost_points |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()  |> 
  print()
```

#### Other streams

  - SPRAGUE RIVER NEAR CHILOQUIN, OR	11501000
  - WILLIAMSON RIVER BLW SPRAGUE RIVER NR CHILOQUIN,OR	11502500
  - WOOD RIVER NEAR KLAMATH AGENCY, OR	11504115
  - FOURMILE CANAL NEAR KLAMATH AGENCY, OR	11504260
  - KLAMATH R AB FALL C NR COPCO CA	11511990
  - LINK RIVER BELOW KENO CANAL, NEAR KLAMATH FALLS,OR	11507501
  - JACKSON CREEK NEAR LENZ, OR	11491470
  - IRVING CREEK NEAR LENZ, OR	11491450
  - LINK RIVER DAM 421401121480900
  - SAND CREEK BLW SAND CREEK CANAL NR CHINCHALO, OR	11492550

  
```{r, include=FALSE}
sprague <- dataRetrieval::readNWISdv(11501000, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "sprague river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11501000",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11501000")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11501000")$dec_long_va # directly add lon
         )
william <- dataRetrieval::readNWISdv(11502500, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "williamson river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11502500",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11502500")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11502500")$dec_long_va # directly add lon
         )
wood <- dataRetrieval::readNWISdv(11504115, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "wood river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11504115",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11504115")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11504115")$dec_long_va # directly add lon
         )
canal <- dataRetrieval::readNWISdv(11504260, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "klamath river canal", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11504260",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11504260")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11504260")$dec_long_va # directly add lon
         )
iron_res  <- dataRetrieval::readNWISdv(11511990, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "klamath river", 
         gage_agency = "USGS",
         gage_number = "11511990",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("11511990")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("11511990")$dec_long_va 
         )
link_rv  <- dataRetrieval::readNWISdv(11507501, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "link river", 
         gage_agency = "USGS",
         gage_number = "11507501",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("11507501")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("11507501")$dec_long_va 
         )
jackson <- dataRetrieval::readNWISdv(11491470, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "williamson river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11491470",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11491470")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11491470")$dec_long_va # directly add lon
         ) 
irving <- dataRetrieval::readNWISdv(11491450, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  # rename to value
  as_tibble() |>
  mutate(stream = "williamson river", # add additional columns for stream, gage info, and parameter
         gage_agency = "USGS",
         gage_number = "11491450",
         parameter = "temperature",
         statistic = "mean", # if query returns instantaneous data then report a min, mean, and max
         latitude = dataRetrieval::readNWISsite("11491450")$dec_lat_va, # directly add lat
         longitude = dataRetrieval::readNWISsite("11491450")$dec_long_va # directly add lon
         ) 

link_rv_dam  <- dataRetrieval::readNWISdv(421401121480900, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "link river", 
         gage_agency = "USGS",
         gage_number = "421401121480900",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("421401121480900")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("421401121480900")$dec_long_va
  )
sand_ck  <- dataRetrieval::readNWISdv(11492550, "00010") |> 
  select(date = Date, value =  X_00010_00003) |>  
  as_tibble() |>
  mutate(stream = "williamson river", 
         gage_agency = "USGS",
         gage_number = "11492550",
         parameter = "temperature",
         statistic = "mean", 
         latitude = dataRetrieval::readNWISsite("11492550")$dec_lat_va, 
         longitude = dataRetrieval::readNWISsite("11492550")$dec_long_va
  )   

other_points <- bind_rows(sprague, william, wood, canal, iron_res, link_rv, jackson, irving, link_rv_dam, sand_ck)
```

##### Date coverage

```{r, echo=FALSE}
other_points |> ggplot(aes(x = date, y = value, color = as.character(gage_number))) + 
  geom_line() + 
  scale_color_manual(values = colors_full) +
  facet_wrap(~gage_number) +
  theme_minimal() +
  labs(title = "Temperature vs Date by Gage Number",
       y = "Temperature")
```

##### Date range summary

```{r, echo=FALSE}
other_points |> 
  group_by(gage_number) |> 
  summarize(
    min_date = min(date),  
    max_date = max(date),  
    record_count = n()) |> 
  ungroup()  |> 
  print()
```
